import Documentation from "df/docs/layouts/documentation";
import ScreenshotWrapper from "df/docs/components/screenshot_wrapper";

export default ({ children }) => (
  <Documentation title="Using version control">{children}</Documentation>
);

## Introduction

Dataform uses the Git version control system to maintain a record of each change made to project files and to manage file versions. Each Dataform project has an associated Git repository.

By default, Dataform will manage your project's Git repository for you. However, projects can be configured to use GitHub instead by clicking the `Migrate project to GitHub` button in Settings.

<div className="bp3-callout bp3-icon-info-sign bp3-intent-primary" markdown="1">
  Version control is tightly integrated into Dataform Web and has consequences on how your data
  pipelines run. We strongly recommend understanding the following concepts before developing your
  tables in Dataform.
</div>

## Workspaces

One of the main benefits of Git is that a developer can work in an isolated "branch" of the file repository without affecting the base files. In Dataform, Git branches correspond to workspaces.

From the `development` workspace - or any other non-`production` workspace - you can edit files (and run those edited scripts on your warehouse, if desired).

Once you are happy with your changes, you can commit them and push them to the `production` workspace. If at any point you make changes that you don't want to commit, you can revert your workspace to its last commit.

Note that the `production` workspace is not directly editable and **all schedules run from the production branch**. This enables users to develop and test changes without affecting the project's data pipelines or affecting other users.

## How to use

By default, you will use the `development` workspace. Anyone on your team can make edits here.

After making changes to files, you can commit the changes:

<img
  src="/static/images/platform_guides/version_control/commit.png"
  style={{ width: "100%", padding: "20px" }}
/>

<ScreenshotWrapper>
<img
  src="/static/images/platform_guides/version_control/commit2.png"
  style={{ width: "100%"}}
/>
</ScreenshotWrapper>

Once you are happy with your changes, push the changes back to the `production` workspace.

<img
  src="/static/images/platform_guides/version_control/push.png"
  style={{ width: "100%", padding: "20px" }}
/>

<div className="bp3-callout bp3-icon-info-sign bp3-intent-warning" markdown="1">
  We recommend that each team member uses their own separate development workspace.
</div>

## Resolving merge conflicts

If other changes have been pushed to the `production` workspace while you were making edits in another workspace, you will need to pull those changes into your workspace first:

<img
  src="/static/images/platform_guides/version_control/pull.png"
  style={{ width: "100%", padding: "20px" }}
/>

There may be conflicting edits that you will have to manually resolve. Files with conflicts are highlighted in the files list. Once you are comfortable with your edits, you can commit and push your changes to `production`.
