syntax = "proto3";

package dataform;

import "protos/core.proto";

// Common structures for Evaluation, execution and compilation.

message Field {
  enum Primitive {
    UNKNOWN = 0;
    INTEGER = 1;
    FLOAT = 2;
    NUMERIC = 5;
    BOOLEAN = 3;
    STRING = 4;
    DATE = 6;
    DATETIME = 7;
    TIMESTAMP = 8;
    TIME = 9;
    BYTES = 10;
    ANY = 11;
    GEOGRAPHY = 12;
  }

  enum Flag {
    UNKNOWN_FLAG = 0;
    REPEATED = 1;
  }

  string name = 1;

  repeated Flag flags = 6;

  oneof type {
    Primitive primitive = 7;
    Fields struct = 3;
  }

  string description = 5;

  reserved 2, 4;
}

message Fields {
  repeated Field fields = 1;
}

message TableMetadata {
  Target target = 1;
  enum Type {
    UNKNOWN = 0;
    TABLE = 1;
    VIEW = 2;
  }
  Type type = 6;

  repeated Field fields = 3;
  string description = 5;
  map<string, string> labels = 7;
  int64 last_updated_millis = 4;

  message BigQuery {
    bool has_streaming_buffer = 1;
  }
  BigQuery bigquery = 8;

  reserved 2;
}

message ExecutionMetadata {
  message BigqueryMetadata {
    string job_id = 1;
    int64 total_bytes_processed = 2;
    int64 total_bytes_billed = 3;
  }
  BigqueryMetadata bigquery = 1;
}
